
<div [formGroup]="patientForm">
  <div fxLayout="column" fxLayoutAlign=" start">
    <div fxLayout="row" fxLayoutAlign=" center">
      <mat-form-field class="input__width">
        <mat-label>First name</mat-label>
        <input matInput type="text" formControlName="firstName">
      </mat-form-field>
      <mat-form-field class="input__width" fxFlexOffset="15px">
        <mat-label>Last name</mat-label>
        <input matInput type="text" formControlName="lastName">
      </mat-form-field>
    </div>
    <div fxLayout="row" fxLayoutAlign="center start">
      <mat-form-field appearance="fill">
        <input matInput formControlName="date" [matDatepicker]="picker">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="input__width" fxFlexOffset="15px">
        <mat-label>VAT code</mat-label>
        <input matInput type="text" formControlName="codeVAT">
      </mat-form-field>
    </div>
    <div fxLayout="row" fxLayoutAlign=" center">
      <mat-form-field class="input__width">
        <mat-label>Email</mat-label>
        <input matInput type="text" formControlName="email">
      </mat-form-field>
    </div>
    <div fxLayout="row" fxLayoutAlign=" center">
      <mat-form-field class="input__width">
        <mat-label>Doctor</mat-label>
        <input type="text"
               placeholder="Pick one"
               aria-label="Number"
               matInput
               formControlName="doctorName"
               [matAutocomplete]="auto">
        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" [displayWith]="displayFn">
          <mat-option *ngFor="let doctor of filteredOptions | async" [value]="doctor">
            <span class="name__font-weight">{{doctor.firstName}}</span>
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
    <div fxLayout="row" fxLayoutAlign=" center">
      <mat-label>Home address</mat-label>
      <button mat-raised-button color="primary"
              (click)="addNewAddress('extend')"
              fxFlexOffset="15px">
        Add new Address
      </button>
    </div>
    <div fxLayout="row" fxLayoutAlign="start center">
      <div formArrayName="addresses">
        <div *ngFor="let address of addresses.controls; let i = index" fxLayout="column" fxLayoutAlign="start">
          <div [formGroupName]="i" fxLayout="column" fxLayoutAlign="start">
            <div fxLayout="row" fxLayoutAlign="start start">
              <mat-form-field class="input__width">
                <mat-label>Phone number</mat-label>
                <input matInput formControlName="phoneNumber" (blur)="onBlurMethod(i)">
              </mat-form-field>
              <mat-form-field class="input__width" fxFlexOffset="15px">
                <mat-label>Street</mat-label>
                <input matInput type="text" formControlName="street">
              </mat-form-field>
              <mat-form-field class="input__width" fxFlexOffset="15px">
                <mat-label>City</mat-label>
                <input matInput type="text" formControlName="city">
              </mat-form-field>
              <mat-form-field class="input__width" fxFlexOffset="15px">
                <mat-label>ZipCode</mat-label>
                <input matInput type="text" formControlName="zipCode">
              </mat-form-field>
              <mat-form-field class="input__width" fxFlexOffset="15px">
                <mat-label>Country</mat-label>
                <input matInput type="text" formControlName="country">
              </mat-form-field>
              <div fxFlexOffset="5px" *ngIf="i > 0">
                <button mat-raised-button color="primary" (click)="removeAddress(i)">Remove</button>
              </div>
            </div>
            <div *ngIf="i > 0">
              <mat-form-field appearance="fill">
                <mat-label>State</mat-label>
                <mat-select formControlName="state" (selectionChange)="change($event.value, i)">
                  <mat-option *ngFor="let item of dropdownValues" [value]="item.key"
                               > <!-- (onSelectionChange)="change($event, item, i)" -->
                    <span class="name__font-weight">{{item.label}}</span>
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field class="input__width" fxFlexOffset="15px"
                              *ngIf="address.value.state === 'WORK' ||
                                     address.value.state === 'CLOSE_RELATIVES'">
                <mat-label>Name</mat-label>
                <input matInput type="text" formControlName="name">
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div>
    <button mat-raised-button color="primary" (click)="save()">Save</button>
  </div>
</div>

